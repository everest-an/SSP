# SSP Web Application TODO

## 已完成功能
- [x] 设计数据库Schema(商户、商品、订单、交易、设备等表)
- [x] 创建数据库迁移
- [x] 实现基础数据查询函数
- [x] 实现商户管理API(CRUD)
- [x] 实现商品管理API(CRUD)
- [x] 实现订单处理API
- [x] 实现交易记录API
- [x] 实现设备注册和管理API
- [x] 实现数据统计和分析API
- [x] 设计整体UI风格和主题
- [x] 创建首页(项目介绍和功能展示)
- [x] 创建商户管理页面
- [x] 创建商品管理页面
- [x] 创建设备管理页面
- [x] 创建数据分析仪表板
- [x] 创建订单列表页面
- [x] 创建订单详情页面
- [x] 实现订单状态管理
- [x] 创建交易记录页面
- [x] 实现交易搜索和筛选
- [x] 实现交易数据导出CSV
- [x] 集成Stripe支付网关
- [x] 实现支付Checkout Session
- [x] 创建支付处理页面(Pricing)
- [x] 实现支付Webhook回调
- [x] 添加订阅计划和一次性产品
- [x] 实现自动订单创建
- [x] 创建Analytics页面
- [x] 实现收入趋势图表
- [x] 实现订单状态分布

## 🚨 核心缺失功能(用户反馈)

### Phase 1: Stripe生产密钥配置
- [x] 配置Stripe生产密钥(sk_live_...)
- [ ] 更新Webhook端点配置
- [ ] 测试生产环境支付流程

### Phase 2: 设备-商户-商品关联系统 ⭐⭐⭐
- [x] 修复设备创建流程(必须关联商户)
- [x] 实现设备与商品目录的关联
- [x] 实现设备扫描商品识别API
- [x] 实现设备权限管理(哪些设备可以访问哪些商品)
- [ ] 创建设备商品配置页面
- [ ] 添加设备状态实时同步

### Phase 3: 客户端钱包系统 ⭐⭐⭐⭐⭐
- [x] 设计钱包数据库Schema
- [x] 实现钱包创建API(非托管钱包)
- [x] 实现钱包托管API(用于流支付)
- [x] 实现钱包余额查询
- [x] 实现钱包充值功能
- [x] 实现钱包提现功能
- [x] 实现钱包交易历史
- [ ] 创建客户端钱包注册页面
- [ ] 集成Web3钱包(MetaMask/WalletConnect)

### Phase 4: 面部识别系统 ⭐⭐⭐⭐⭐
- [x] 设计用户生物识别数据Schema
- [x] 实现面部特征存储API
- [x] 实现面部识别验证API
- [x] 实现面部识别与Stripe绑定
- [x] 集成MediaPipe面部检测工具
- [ ] 创建面部注册页面
- [ ] 集成设备端面部识别
- [ ] 添加面部识别安全设置

### Phase 5: 支付手势认证 ⭐⭐⭐⭐⭐
- [x] 设计手势数据Schema
- [x] 实现手部追踪API(MediaPipe Hands)
- [x] 实现"拿起"手势识别(YES手势)
- [x] 实现手势状态机(5状态)
- [x] 集成MediaPipe手势识别工具
- [ ] 创建支付手势注册页面
- [ ] 集成手势与订单创建
- [ ] 实现手势超时取消机制

### Phase 6: 客户端账户管理 ⭐⭐⭐⭐
- [ ] 创建客户端用户注册页面
- [ ] 实现客户端登录系统
- [ ] 创建客户端个人资料页面
- [ ] 实现支付方式管理
- [ ] 实现订单历史查看
- [ ] 实现账户安全设置
- [ ] 实现多因素认证(MFA)

### Phase 7: 实时订单创建流程 ⭐⭐⭐⭐⭐
- [ ] 实现设备扫描商品API
- [ ] 实现实时订单创建(手势触发)
- [ ] 实现订单金额计算
- [ ] 实现钱包自动扣款
- [ ] 实现订单状态推送(WebSocket)
- [ ] 实现订单失败回滚
- [ ] 添加订单通知系统

### Phase 8: 系统集成测试
- [ ] 完整流程测试(注册→绑定钱包→面部识别→拿起商品→支付)
- [ ] 设备端集成测试
- [ ] 支付流程压力测试
- [ ] 安全性测试
- [ ] 性能优化
- [ ] 文档完善

## 技术债务
- [ ] 添加错误日志系统
- [ ] 实现API限流
- [ ] 添加数据备份机制
- [ ] 优化数据库查询性能
- [ ] 添加监控和告警

## 商家后台管理系统 ⭐⭐⭐⭐⭐

### 用户管理模块
- [x] 创建用户列表页面(显示所有注册用户)
- [x] 实现用户详情查看(个人信息、钱包、面部识别状态)
- [x] 实现用户搜索和筛选功能
- [x] 添加用户钱包余额查看
- [x] 添加用户交易历史查看
- [x] 实现用户状态管理(激活/禁用)

### 交易监控模块
- [x] 创建实时交易监控Dashboard
- [x] 实现交易列表(所有商户的交易记录)
- [x] 添加交易详情查看(订单、用户、商品、金额)
- [x] 实现交易搜索和筛选(按日期、状态、金额)
- [x] 添加交易统计图表(总交易、收入、成功率)
- [x] 实现交易数据导出(CSV)
- [ ] 添加异常交易告警

### 商户管理模块
- [x] 创建商户列表页面
- [x] 实现商户详情查看(业务信息、设备、商品)
- [x] 添加商户数据统计(销售额、订单量、设备数)
- [ ] 添加商户审核功能
- [ ] 实现商户状态管理(激活/暂停/封禁)

### 设备配置模块
- [ ] 创建设备商品配置页面
- [ ] 实现设备关联商品管理
- [ ] 添加设备权限配置
- [ ] 实现设备状态实时监控
- [ ] 添加设备日志查看

### 数据分析模块
- [ ] 创建高级数据分析Dashboard
- [ ] 实现用户行为分析
- [ ] 添加销售趋势图表
- [ ] 实现商品销售排行
- [ ] 添加设备性能分析
- [ ] 实现自定义报表生成
